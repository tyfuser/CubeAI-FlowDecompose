# 📹 视频镜头拆解分析功能 - 使用指南

## 🎯 功能概述

全新的"镜头拆解分析"功能已加入项目，可以自动分析视频的镜头构成、运镜技巧、光线布局和调色风格。这是一个独立的模块，不会影响现有的"视频深度拆解"功能。

---

## 🚀 快速开始

### 1. 访问功能

在侧边栏中点击 **"镜头拆解分析"** 菜单项（🎬 图标）

### 2. 上传视频

有两种方式上传视频：

**方式一：拖拽上传**
- 直接将视频文件拖拽到上传区域
- 支持 MP4, MOV, AVI 等常见格式
- 最大支持 500MB

**方式二：输入路径**
- 在输入框中输入本地文件路径
- 例如：`/Users/tang/Videos/sample.mp4`

### 3. 开始分析

- 点击 **"开始分析"** 按钮
- 系统会自动：
  - 上传视频文件
  - 检测场景切换
  - 分析每个镜头的特征
  - 生成可视化时间轴

### 4. 查看结果

分析完成后，会显示：

- **时间标尺** - 显示整个视频的时间线
- **镜头片段轨道** - 每个镜头的起止时间
- **运镜轨道** - 识别的运镜技巧（特写、全景、推拉等）
- **光线轨道** - 识别的光线布局（三点布光、自然光等）
- **调色轨道** - 识别的调色风格（暖色调、冷色调等）

### 5. 查看详情

- 点击任意时间轴上的镜头片段
- 右侧会滑出详情面板，显示：
  - 镜头基本信息（时间、时长）
  - 各项特征的详细描述
  - 技术术语和用途说明

---

## 🎨 界面说明

### 主界面

```
┌─────────────────────────────────────────────┐
│ 视频镜头拆解分析                              │
│ 上传视频，自动识别镜头、运镜、光线和调色技巧      │
├─────────────────────────────────────────────┤
│ [开始分析] [历史记录]                         │
├─────────────────────────────────────────────┤
│                                             │
│  ┌───────────────────────────────────┐     │
│  │  📁 点击或拖拽视频文件至此          │     │
│  │     支持 MP4, MOV, AVI 等格式      │     │
│  └───────────────────────────────────┘     │
│                                             │
│  或直接输入路径: ________________           │
│                                             │
│  [开始分析]                                 │
└─────────────────────────────────────────────┘
```

### 时间轴界面

```
┌─────────────────────────────────────────────┐
│ 分析结果                                     │
├─────────────────────────────────────────────┤
│ 时间标尺: 00:00  ...  00:30  ...  01:00    │
├─────────────────────────────────────────────┤
│ 📹 镜头片段:                                 │
│ ▓▓▓▓  ▓▓▓▓▓▓  ▓▓▓  ▓▓▓▓▓                   │
├─────────────────────────────────────────────┤
│ 🎥 运镜:                                     │
│ [特写] [中景] [推镜] [全景]                  │
├─────────────────────────────────────────────┤
│ 💡 光线:                                     │
│ [三点布光] [自然光] [背光]                   │
├─────────────────────────────────────────────┤
│ 🎨 调色:                                     │
│ [暖色调] [冷色调] [高对比]                   │
└─────────────────────────────────────────────┘
```

---

## 🔧 API 配置

### 后端要求

新功能使用独立的 API 接口：

- **基础路径**: `http://localhost:8000/v1/video-analysis`
- **创建任务**: `POST /v1/video-analysis/jobs`
- **查询状态**: `GET /v1/video-analysis/jobs/{job_id}`
- **历史记录**: `GET /v1/video-analysis/history`
- **删除任务**: `DELETE /v1/video-analysis/jobs/{job_id}`

### 环境变量配置

在 `.env` 文件中配置后端地址：

```env
# 原有分析功能的 API（不变）
VITE_API_BASE_URL=http://localhost:3000/api/v1

# 新增：镜头拆解功能的 API
VITE_SHOT_ANALYSIS_BASE_URL=http://localhost:8000
```

如果不配置新变量，将使用默认地址 `http://localhost:8000`。

---

## 📊 数据结构

### Segment (镜头片段)

```typescript
interface Segment {
  segment_id: string;         // 片段ID，如 "seg_0001"
  start_ms: number;            // 开始时间（毫秒）
  end_ms: number;              // 结束时间（毫秒）
  duration_ms: number;         // 时长（毫秒）
  features: Feature[];         // 特征列表
}
```

### Feature (特征)

```typescript
interface Feature {
  category: 'camera_motion' | 'lighting' | 'color_grading';
  type: string;                // 具体类型，如 "close_up"
  value: string;               // 显示值，如 "特写"
  confidence: number;          // 置信度 (0-1)
  detailed_description?: {
    summary: string;           // 总结
    technical_terms: string[]; // 专业术语
    purpose: string;           // 用途
  };
}
```

### 特征类别

#### camera_motion (运镜)
- `close_up`: 特写
- `medium_shot`: 中景
- `wide_shot`: 全景
- `pan_left` / `pan_right`: 左右摇
- `zoom_in` / `zoom_out`: 推拉镜
- `tracking_shot`: 跟镜

#### lighting (光线)
- `three_point`: 三点布光
- `natural_light`: 自然光
- `back_light`: 背光
- `low_key` / `high_key`: 低调光/高调光

#### color_grading (调色)
- `warm_tones` / `cool_tones`: 暖色调/冷色调
- `high_contrast` / `low_contrast`: 高对比/低对比
- `vibrant` / `desaturated`: 鲜艳/去饱和

---

## 🆚 与现有功能的区别

| 功能 | 视频深度拆解 | 镜头拆解分析 |
|-----|------------|------------|
| **入口** | 总览面板 | 独立菜单项 |
| **API 路径** | `/analysis/*` | `/v1/video-analysis/*` |
| **分析重点** | 爆款因素、节奏、钩子 | 镜头、运镜、光线、调色 |
| **结果展示** | 雷达图、节奏曲线 | 时间轴、特征轨道 |
| **使用场景** | 学习爆款视频 | 学习拍摄技巧 |

两个功能互不影响，可以同时使用！

---

## 🎓 使用技巧

### 1. 学习专业术语

点击镜头片段查看详情，里面有：
- 技术术语的中文说明
- 每种技巧的用途和效果
- 实际应用场景

### 2. 对比分析

- 分析多个同类型视频
- 在历史记录中对比不同视频的镜头构成
- 总结成功作品的共同点

### 3. 导出学习笔记

- 记录识别出的关键技巧
- 截图保存特征轨道
- 整理成自己的拍摄清单

---

## 🐛 故障排查

### 问题：无法连接后端

**解决方案**：
1. 检查后端服务是否启动在 `localhost:8000`
2. 查看浏览器控制台的网络请求
3. 确认 `.env` 文件配置正确

### 问题：分析一直停留在某个进度

**解决方案**：
1. 等待最多 2 分钟（120 次轮询）
2. 检查后端日志是否有错误
3. 尝试上传更小的视频文件
4. 在历史记录中查看是否有部分结果

### 问题：识别结果不准确

**原因**：
- AI 模型的置信度较低
- 视频质量不佳
- 镜头变化不明显

**建议**：
- 选择画质清晰的视频
- 避免过度剪辑的视频
- 参考置信度分数（>80% 较可靠）

---

## 📞 技术支持

如遇问题，请查看：
- **集成指南**: `FRONTEND_INTEGRATION_GUIDE.md`
- **API 文档**: `API_DOCUMENTATION.md`
- **控制台日志**: 浏览器开发者工具

---

## 🎉 开始使用

现在就点击侧边栏的 **"镜头拆解分析"** 开始体验吧！

将你喜欢的视频上传，看看专业视频人是如何运用镜头语言的！

